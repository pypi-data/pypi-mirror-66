function showWorkflow(e,t,a){var o,n,i=document.getElementById("id_main-"+t);"select-one"===i.type&&(o=i.options[i.selectedIndex].value,n=i.options[i.selectedIndex].text),ftl_modal(o,"7","/common/workflow/process_graph/"+o+"/",n,a)}function ftl_modal(e,t,a,o,n){void 0===n&&(n="modal-lg"),ftl_modal_mount=riot.mount("div#ftl-modal","ftl-modal",{modal:{isvisible:!1,contextmenu:!1,cls:n},data:{pk:e,acao:t,acaoURL:a,modaltitle:o}})}function changeUF2(e,t){if(!(e.selectedIndex<0)){var a=e.options[e.selectedIndex].value,o=e.getAttribute("data-app_label"),n=e.getAttribute("data-object_name"),i="id_";e.id.lastIndexOf("-")>=0&&(i=e.id.substring(0,e.id.lastIndexOf("-")+1));var l=i+"municipio";if(""!==a){var r=e.closest("div[class^='tab-pane active']"),d=$(r).find('select[id="'+l+'"]');d.attr("disabled",!0).html('<option value="">Aguarde...</option>'),d.load("/cliente/municipio/ajax/"+a+"/"+o+"/"+n+"/",null,(function(){d[0].disabled=!1,""!==t&&$("#"+l).val(t)}))}else jQuery(l).html('<option value="">--</option>')}}function changeUF(e){changeUF2(e,"")}function changeCEP(e){var t=$(e).val().replace(/\D/g,"");if(""!==t){if(/^[0-9]{8}$/.test(t)){var a="id_";e.id.lastIndexOf("-")>=0&&(a=e.id.substring(0,e.id.lastIndexOf("-")+1));var o=e.closest("div[class^='tab-pane active']"),n=$(o),i=n.find('input[id="'+a+'endereco"]'),l=n.find('input[id="'+a+'bairro"]'),r=n.find('select[id="'+a+'estado"]'),d=n.find('select[id="'+a+'municipio"]');i.val("..."),l.val("..."),r[0].value="",d[0].value="",$.getJSON("//viacep.com.br/ws/"+t+"/json/unicode/?callback=?",(function(e){"erro"in e?(limpa_formulario_cep(),alert("CEP não encontrado.")):(i.val(e.logradouro),l.val(e.bairro),r[0].value=e.uf,changeUF2(r[0],e.ibge),d[0].value=e.ibge)}))}else limpa_formulario_cep(),alert("Formato de CEP inválido.")}else limpa_formulario_cep()}function changeContaDestino(e,t){var a="#id_"+t,o=e.options[e.selectedIndex].value;if(""!==o){var n=e.getAttribute("data-app_label"),i=e.getAttribute("data-object_name"),l="/"+n+"/ajax"+i+"Select/"+$("#planodecontas").val()+"/"+o+"/"+n+"/"+i+"/",r=jQuery(a);r.attr("disabled",!0).html('<option value="">Aguarde...</option>'),r.load(l,null,(function(){r[0].disabled=!1,$(a).prepend('<option value="" selected>---------</option>')}))}else jQuery(a).html('<option value="">--</option>')}function changeContaOrigemProvisao(e,t,a){changeContaDestino(e,t),changeContaDestino(e,a)}function limpa_formulario_cep(){$("#id_endereco").val(""),$("#id_bairro").val("")}function setHeight(e){e.each((function(e,t){t.style.overflow="hidden",t.style.height=0,t.style.height=`${t.scrollHeight+2}px`}))}function getCookie(e){var t=null;if(document.cookie&&""!==document.cookie)for(var a=document.cookie.split(";"),o=0;o<a.length;o++){var n=jQuery.trim(a[o]);if(n.substring(0,e.length+1)===e+"="){t=decodeURIComponent(n.substring(e.length+1));break}}return t}$.ajaxSetup({beforeSend:function(e,t){this.crossDomain||(csrftoken=getCookie("csrftoken"),e.setRequestHeader("HTTP_X_CSRFTOKEN",csrftoken),e.setRequestHeader("X-CSRFToken",csrftoken))}});var csrftoken=getCookie("csrftoken");function csrfSafeMethod(e){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(e)}function configuraCampos(e,t){var a=$(".disableMe"),o=$(".disableMe select[data-autocomplete-light-function='select2']");e?(a.removeProp("disabled"),a.prop("disabled","disabled"),a.has(".has-error").removeProp("disabled"),a.filter("SPAN").css("pointer-events","none"),o.removeProp("disabled"),o.prop("disabled","disabled"),o.has(".has-error").removeProp("disabled"),$("div[id*=__prefix__]").find(".disableMe").removeProp("disabled"),t&&$('input[name="save"]').hide()):a.removeProp("disabled"),t&&$('a[id^="add-item-button"]').hide(),$("form").each((function(){$(this).submit((function(){$(":disabled").removeProp("disabled")}))}))}function configuraPagina(){$(".js-django-inlines").each((function(){var e=$(this),t=e.data();t.options.onAdd=function(e,t){configuraPagina()},e.djangoInline(t.options||t),t.djangoInline.setFormOrder()})),$.fn.datepicker.defaults.format="dd/mm/yyyy",$.fn.datepicker.defaults.todayBtn="linked",$.fn.datepicker.defaults.language="pt-BR",$.fn.datepicker.defaults.autoclose=!0,$.fn.datepicker.defaults.todayHighlight=!0,$.fn.datepicker.defaults.enableOnReadonly=!0,$("#datepicker").datepicker({}),$(".dateinput").datepicker({format:"dd/mm/yyyy",todayBtn:"linked",language:"pt-BR",autoclose:!0,todayHighlight:!0,enableOnReadonly:!1}),$("div .has-error").filter(".form-group").has($('div[id^="detail-items-"]')).removeClass("has-error"),$("[data-ftl='data']").mask("99/99/9999",{placeholder:"dd/mm/aaaa"}),$("[data-ftl='datahora']").mask("99/99/9999 99:99",{placeholder:"dd/mm/aaaa hh:mm"}),$("[data-ftl='telefone']").mask("(99) 9999-999?9"),$("[data-ftl='celular']").mask("(99) 99999-999?9"),$("[data-ftl='cpf']").mask("999.999.999-99"),$("[data-ftl='cnpj']").mask("99.999.999/9999-99"),$("[data-ftl='cep']").mask("99999-999"),$('form input:not([type="hidden"]):not([type="submit"])').keydown((function(e){if("Enter"===e.key){var t=$(this).parents("form").eq(0).find(":input");return null!==t[t.index(this)+1]&&t[t.index(this)+1].focus(),e.preventDefault(),!1}})),$(".tab-content .panel-body").each((function(){$(this).find(".buttons-do-form").appendTo($(this).parent().find("#master-button"))})),$.isFunction($.fn.summernote)&&($(".summernote").not("[id*='__prefix__']").summernote({toolbar:[["style",["style"]],["font",["bold","underline","italic","strikethrough","superscript","subscript","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","listStyles","paragraph","height"]],["table",["table"]],["insert",["link","picture","video","hr"]],["specialchars",["specialchars"]],["comment",["commentDialog","commentsShow","commentsHide"]],["view",["fullscreen","codeview","help"]]],disableDragAndDrop:!0,disableResizeEditor:!0,placeholder:"Conteúdo em HTML",tabsize:2,height:100,callbacks:{onChange:function(e,t){setHeight(t)},onInit:function(){}}}),$(".summernote-readonly").not("[id*='__prefix__']").summernote({toolbar:[["font",["bold","underline","italic","strikethrough","clear"]],["color",["color"]],["comment",["commentDialog","commentsShow","commentsHide"]]],disableDragAndDrop:!0,disableResizeEditor:!0,placeholder:"Conteúdo em HTML",tabsize:2,height:100,callbacks:{onChange:function(e,t){setHeight(t)},onPaste:function(e){e.preventDefault()},onKeydown:function(e){e.preventDefault()},onKeyup:function(e){e.preventDefault()},onInit:function(){}}}).parent().find(".note-editor").on("dragstart",(function(e){e.preventDefault()})).bind("contextmenu",(function(e){return!1})),$(".note-toolbar").addClass("fixedElement"),$(".note-statusbar").hide(),$(".ext-comment-popover").hide()),$(".tooltip").remove(),setHeight($(".note-editable:visible")),$(".dal-forward-conf").not("[id*='__prefix__']").each((function(){var e,t=this.id.replace("dal-forward-conf-for-","#"),a=$(t),o=a.getFormPrefix();try{e=JSON.parse($(this).text())}catch(e){return}e.forEach((function(e){$("[name="+o+e.src+"]").on("change",(function(){a.val(null).trigger("change")}))}))})),$(".ftl-automount:visible").each((function(e,t){t._tag||(riot.mount(t),t.classList.remove("ftl-automount"))})),$(".ftl-calendar:visible").each((function(e,t){update_calendar(t)}))}var rotas=[];function configuraFTL(){moment.locale("pt-br"),configuraPagina();var e=window.location,t=$('li a[href="'+e.pathname+'"]');if(t.length>0)t.parent().addClass("active"),$("ul.treeview-menu").filter((function(t){return 1===$("a[href^='"+e.pathname+"']",this).length})).addClass("active").css("display","block");else if(document.referrer){var a=document.referrer.match(/:\/\/[^\/]+([^\?]*)[\/]*(?:\?.*)?$/)[1];$('li a[href^="'+a+'"]').length>0&&($('li a[href="'+a+'"]').parent().addClass("active"),$("ul.treeview-menu").filter((function(e){return 1===$("a[href^='"+a+"']",this).length})).addClass("active").css("display","block"))}ftltabs=riot.mount("ftl-tabs")[0],route("/..",(function(e){var t=window.location,a=t.hash.slice(1);rotas.forEach((function(e,o){if(e.rota===a.slice(0,e.rota.length)){var n="";t.hash.endsWith("/add/")?n="Inclusão":"2"===t.hash.split("/")[4]?n="Alteração":"3"===t.hash.split("/")[4]&&(n="Exclusão"),ftltabs.trigger("updateRoute",o,e.nome,a,n,e.reload)}}))})),route.start(!0)}function formset_up(e){var t=$(e).closest(".js-django-inlines").data().djangoInline,a=t.getFormIndex(e);t.moveFieldUp(a)}function formset_down(e){var t=$(e).closest(".js-django-inlines").data().djangoInline,a=t.getFormIndex(e);t.moveFieldDown(a)}function update_calendar(e){var t=e.dataset.url;$.ajax({type:"GET",url:t,success:function(t){new FullCalendar.Calendar(e,{plugins:["dayGrid"],header:{center:"dayGridMonth,dayGridWeek"},eventRender:function(e){e.el.setAttribute("data-container","body"),e.el.setAttribute("data-toggle","tooltip"),e.el.setAttribute("data-html","true"),e.el.setAttribute("data-placement","auto"),e.el.setAttribute("title",e.event.extendedProps.description)},timeZone:"local",locale:"pt-BR",draggable:!1,droppable:!1,height:.8*$(window).height(),contentHeight:"auto",events:t,loading:function(e){e?$("#loading").show():$("#loading").hide()}}).render()},error:function(e){console.log("Erro no ajax do calendar")}})}$(window).scroll((function(e){var t=$(".fixedElement:visible"),a="fixed"===t.css("position");$(this).scrollTop()>260&&!a&&t.css({position:"fixed",top:"0px"}),$(this).scrollTop()<=260&&a&&t.css({position:"static",top:"0px"}),t.css({width:t.parent().find(".note-editing-area").width()+"px"})}));
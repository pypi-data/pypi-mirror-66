#!/bin/bash

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"

echo -n "Username: "
read user
echo -n "Password: "
read -s pass

cd "$DIR/.."

rm -rf dist
python3 setup.py sdist bdist_wheel

echo "Checking vulnerabilities..."
pipenv check || exit 1
pipenv run twine check dist/* || exit 1

echo "Uploading package..."
pipenv run twine upload dist/* -u "$user" -p "$pass"

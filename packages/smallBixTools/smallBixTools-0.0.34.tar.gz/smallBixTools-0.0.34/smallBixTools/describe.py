import argparse
import os
import argparse
from jinja2 import Environment, FileSystemLoader
from weasyprint import HTML
import smallBixTools as st
from Bio import pairwise2
import sys


hxb2_forward = """tggaagggctaattcactcccaacgaagacaagatatccttgatctgtggatctaccacacacaaggctacttccctgattagcagaactacacaccagggccagggatcagatatccactgacctttggatggtgctacaagctagtaccagttgagccagagaagttagaagaagccaacaaaggagagaacaccagcttgttacaccctgtgagcctgcatggaatggatgacccggagagagaagtgttagagtggaggtttgacagccgcctagcatttcatcacatggcccgagagctgcatccggagtacttcaagaactgctgacatcgagcttgctacaagggactttccgctggggactttccagggaggcgtggcctgggcgggactggggagtggcgagccctcagatcctgcatataagcagctgctttttgcctgtactgggtctctctggttagaccagatctgagcctgggagctctctggctaactagggaacccactgcttaagcctcaataaagcttgccttgagtgcttcaagtagtgtgtgcccgtctgttgtgtgactctggtaactagagatccctcagacccttttagtcagtgtggaaaatctctagcagtggcgcccgaacagggacctgaaagcgaaagggaaaccagaggagctctctcgacgcaggactcggcttgctgaagcgcgcacggcaagaggcgaggggcggcgactggtgagtacgccaaaaattttgactagcggaggctagaaggagagagatgggtgcgagagcgtcagtattaagcgggggagaattagatcgatgggaaaaaattcggttaaggccagggggaaagaaaaaatataaattaaaacatatagtatgggcaagcagggagctagaacgattcgcagttaatcctggcctgttagaaacatcagaaggctgtagacaaatactgggacagctacaaccatcccttcagacaggatcagaagaacttagatcattatataatacagtagcaaccctctattgtgtgcatcaaaggatagagataaaagacaccaaggaagctttagacaagatagaggaagagcaaaacaaaagtaagaaaaaagcacagcaagcagcagctgacacaggacacagcaatcaggtcagccaaaattaccctatagtgcagaacatccaggggcaaatggtacatcaggccatatcacctagaactttaaatgcatgggtaaaagtagtagaagagaaggctttcagcccagaagtgatacccatgttttcagcattatcagaaggagccaccccacaagatttaaacaccatgctaaacacagtggggggacatcaagcagccatgcaaatgttaaaagagaccatcaatgaggaagctgcagaatgggatagagtgcatccagtgcatgcagggcctattgcaccaggccagatgagagaaccaaggggaagtgacatagcaggaactactagtacccttcaggaacaaataggatggatgacaaataatccacctatcccagtaggagaaatttataaaagatggataatcctgggattaaataaaatagtaagaatgtatagccctaccagcattctggacataagacaaggaccaaaggaaccctttagagactatgtagaccggttctataaaactctaagagccgagcaagcttcacaggaggtaaaaaattggatgacagaaaccttgttggtccaaaatgcgaacccagattgtaagactattttaaaagcattgggaccagcggctacactagaagaaatgatgacagcatgtcagggagtaggaggacccggccataaggcaagagttttggctgaagcaatgagccaagtaacaaattcagctaccataatgatgcagagaggcaattttaggaaccaaagaaagattgttaagtgtttcaattgtggcaaagaagggcacacagccagaaattgcagggcccctaggaaaaagggctgttggaaatgtggaaaggaaggacaccaaatgaaagattgtactgagagacaggctaattttttagggaagatctggccttcctacaagggaaggccagggaattttcttcagagcagaccagagccaacagccccaccagaagagagcttcaggtctggggtagagacaacaactccccctcagaagcaggagccgatagacaaggaactgtatcctttaacttccctcaggtcactctttggcaacgacccctcgtcacaataaagataggggggcaactaaaggaagctctattagatacaggagcagatgatacagtattagaagaaatgagtttgccaggaagatggaaaccaaaaatgatagggggaattggaggttttatcaaagtaagacagtatgatcagatactcatagaaatctgtggacataaagctataggtacagtattagtaggacctacacctgtcaacataattggaagaaatctgttgactcagattggttgcactttaaattttcccattagccctattgagactgtaccagtaaaattaaagccaggaatggatggcccaaaagttaaacaatggccattgacagaagaaaaaataaaagcattagtagaaatttgtacagagatggaaaaggaagggaaaatttcaaaaattgggcctgaaaatccatacaatactccagtatttgccataaagaaaaaagacagtactaaatggagaaaattagtagatttcagagaacttaataagagaactcaagacttctgggaagttcaattaggaataccacatcccgcagggttaaaaaagaaaaaatcagtaacagtactggatgtgggtgatgcatatttttcagttcccttagatgaagacttcaggaagtatactgcatttaccatacctagtataaacaatgagacaccagggattagatatcagtacaatgtgcttccacagggatggaaaggatcaccagcaatattccaaagtagcatgacaaaaatcttagagccttttagaaaacaaaatccagacatagttatctatcaatacatggatgatttgtatgtaggatctgacttagaaatagggcagcatagaacaaaaatagaggagctgagacaacatctgttgaggtggggacttaccacaccagacaaaaaacatcagaaagaacctccattcctttggatgggttatgaactccatcctgataaatggacagtacagcctatagtgctgccagaaaaagacagctggactgtcaatgacatacagaagttagtggggaaattgaattgggcaagtcagatttacccagggattaaagtaaggcaattatgtaaactccttagaggaaccaaagcactaacagaagtaataccactaacagaagaagcagagctagaactggcagaaaacagagagattctaaaagaaccagtacatggagtgtattatgacccatcaaaagacttaatagcagaaatacagaagcaggggcaaggccaatggacatatcaaatttatcaagagccatttaaaaatctgaaaacaggaaaatatgcaagaatgaggggtgcccacactaatgatgtaaaacaattaacagaggcagtgcaaaaaataaccacagaaagcatagtaatatggggaaagactcctaaatttaaactgcccatacaaaaggaaacatgggaaacatggtggacagagtattggcaagccacctggattcctgagtgggagtttgttaatacccctcccttagtgaaattatggtaccagttagagaaagaacccatagtaggagcagaaaccttctatgtagatggggcagctaacagggagactaaattaggaaaagcaggatatgttactaatagaggaagacaaaaagttgtcaccctaactgacacaacaaatcagaagactgagttacaagcaatttatctagctttgcaggattcgggattagaagtaaacatagtaacagactcacaatatgcattaggaatcattcaagcacaaccagatcaaagtgaatcagagttagtcaatcaaataatagagcagttaataaaaaaggaaaaggtctatctggcatgggtaccagcacacaaaggaattggaggaaatgaacaagtagataaattagtcagtgctggaatcaggaaagtactatttttagatggaatagataaggcccaagatgaacatgagaaatatcacagtaattggagagcaatggctagtgattttaacctgccacctgtagtagcaaaagaaatagtagccagctgtgataaatgtcagctaaaaggagaagccatgcatggacaagtagactgtagtccaggaatatggcaactagattgtacacatttagaaggaaaagttatcctggtagcagttcatgtagccagtggatatatagaagcagaagttattccagcagaaacagggcaggaaacagcatattttcttttaaaattagcaggaagatggccagtaaaaacaatacatactgacaatggcagcaatttcaccggtgctacggttagggccgcctgttggtgggcgggaatcaagcaggaatttggaattccctacaatccccaaagtcaaggagtagtagaatctatgaataaagaattaaagaaaattataggacaggtaagagatcaggctgaacatcttaagacagcagtacaaatggcagtattcatccacaattttaaaagaaaaggggggattggggggtacagtgcaggggaaagaatagtagacataatagcaacagacatacaaactaaagaattacaaaaacaaattacaaaaattcaaaattttcgggtttattacagggacagcagaaatccactttggaaaggaccagcaaagctcctctggaaaggtgaaggggcagtagtaatacaagataatagtgacataaaagtagtgccaagaagaaaagcaaagatcattagggattatggaaaacagatggcaggtgatgattgtgtggcaagtagacaggatgaggattagaacatggaaaagtttagtaaaacaccatatgtatgtttcagggaaagctaggggatggttttatagacatcactatgaaagccctcatccaagaataagttcagaagtacacatcccactaggggatgctagattggtaataacaacatattggggtctgcatacaggagaaagagactggcatttgggtcagggagtctccatagaatggaggaaaaagagatatagcacacaagtagaccctgaactagcagaccaactaattcatctgtattactttgactgtttttcagactctgctataagaaaggccttattaggacacatagttagccctaggtgtgaatatcaagcaggacataacaaggtaggatctctacaatacttggcactagcagcattaataacaccaaaaaagataaagccacctttgcctagtgttacgaaactgacagaggatagatggaacaagccccagaagaccaagggccacagagggagccacacaatgaatggacactagagcttttagaggagcttaagaatgaagctgttagacattttcctaggatttggctccatggcttagggcaacatatctatgaaacttatggggatacttgggcaggagtggaagccataataagaattctgcaacaactgctgtttatccattttcagaattgggtgtcgacatagcagaataggcgttactcgacagaggagagcaagaaatggagccagtagatcctagactagagccctggaagcatccaggaagtcagcctaaaactgcttgtaccaattgctattgtaaaaagtgttgctttcattgccaagtttgtttcataacaaaagccttaggcatctcctatggcaggaagaagcggagacagcgacgaagagctcatcagaacagtcagactcatcaagcttctctatcaaagcagtaagtagtacatgtaacgcaacctataccaatagtagcaatagtagcattagtagtagcaataataatagcaatagttgtgtggtccatagtaatcatagaatataggaaaatattaagacaaagaaaaatagacaggttaattgatagactaatagaaagagcagaagacagtggcaatgagagtgaaggagaaatatcagcacttgtggagatgggggtggagatggggcaccatgctccttgggatgttgatgatctgtagtgctacagaaaaattgtgggtcacagtctattatggggtacctgtgtggaaggaagcaaccaccactctattttgtgcatcagatgctaaagcatatgatacagaggtacataatgtttgggccacacatgcctgtgtacccacagaccccaacccacaagaagtagtattggtaaatgtgacagaaaattttaacatgtggaaaaatgacatggtagaacagatgcatgaggatataatcagtttatgggatcaaagcctaaagccatgtgtaaaattaaccccactctgtgttagtttaaagtgcactgatttgaagaatgatactaataccaatagtagtagcgggagaatgataatggagaaaggagagataaaaaactgctctttcaatatcagcacaagcataagaggtaaggtgcagaaagaatatgcatttttttataaacttgatataataccaatagataatgatactaccagctataagttgacaagttgtaacacctcagtcattacacaggcctgtccaaaggtatcctttgagccaattcccatacattattgtgccccggctggttttgcgattctaaaatgtaataataagacgttcaatggaacaggaccatgtacaaatgtcagcacagtacaatgtacacatggaattaggccagtagtatcaactcaactgctgttaaatggcagtctagcagaagaagaggtagtaattagatctgtcaatttcacggacaatgctaaaaccataatagtacagctgaacacatctgtagaaattaattgtacaagacccaacaacaatacaagaaaaagaatccgtatccagagaggaccagggagagcatttgttacaataggaaaaataggaaatatgagacaagcacattgtaacattagtagagcaaaatggaataacactttaaaacagatagctagcaaattaagagaacaatttggaaataataaaacaataatctttaagcaatcctcaggaggggacccagaaattgtaacgcacagttttaattgtggaggggaatttttctactgtaattcaacacaactgtttaatagtacttggtttaatagtacttggagtactgaagggtcaaataacactgaaggaagtgacacaatcaccctcccatgcagaataaaacaaattataaacatgtggcagaaagtaggaaaagcaatgtatgcccctcccatcagtggacaaattagatgttcatcaaatattacagggctgctattaacaagagatggtggtaatagcaacaatgagtccgagatcttcagacctggaggaggagatatgagggacaattggagaagtgaattatataaatataaagtagtaaaaattgaaccattaggagtagcacccaccaaggcaaagagaagagtggtgcagagagaaaaaagagcagtgggaataggagctttgttccttgggttcttgggagcagcaggaagcactatgggcgcagcctcaatgacgctgacggtacaggccagacaattattgtctggtatagtgcagcagcagaacaatttgctgagggctattgaggcgcaacagcatctgttgcaactcacagtctggggcatcaagcagctccaggcaagaatcctggctgtggaaagatacctaaaggatcaacagctcctggggatttggggttgctctggaaaactcatttgcaccactgctgtgccttggaatgctagttggagtaataaatctctggaacagatttggaatcacacgacctggatggagtgggacagagaaattaacaattacacaagcttaatacactccttaattgaagaatcgcaaaaccagcaagaaaagaatgaacaagaattattggaattagataaatgggcaagtttgtggaattggtttaacataacaaattggctgtggtatataaaattattcataatgatagtaggaggcttggtaggtttaagaatagtttttgctgtactttctatagtgaatagagttaggcagggatattcaccattatcgtttcagacccacctcccaaccccgaggggacccgacaggcccgaaggaatagaagaagaaggtggagagagagacagagacagatccattcgattagtgaacggatccttggcacttatctgggacgatctgcggagcctgtgcctcttcagctaccaccgcttgagagacttactcttgattgtaacgaggattgtggaacttctgggacgcagggggtgggaagccctcaaatattggtggaatctcctacagtattggagtcaggaactaaagaatagtgctgttagcttgctcaatgccacagccatagcagtagctgaggggacagatagggttatagaagtagtacaaggagcttgtagagctattcgccacatacctagaagaataagacagggcttggaaaggattttgctataagatgggtggcaagtggtcaaaaagtagtgtgattggatggcctactgtaagggaaagaatgagacgagctgagccagcagcagatagggtgggagcagcatctcgagacctggaaaaacatggagcaatcacaagtagcaatacagcagctaccaatgctgcttgtgcctggctagaagcacaagaggaggaggaggtgggttttccagtcacacctcaggtacctttaagaccaatgacttacaaggcagctgtagatcttagccactttttaaaagaaaaggggggactggaagggctaattcactcccaaagaagacaagatatccttgatctgtggatctaccacacacaaggctacttccctgattagcagaactacacaccagggccaggggtcagatatccactgacctttggatggtgctacaagctagtaccagttgagccagataagatagaagaggccaataaaggagagaacaccagcttgttacaccctgtgagcctgcatgggatggatgacccggagagagaagtgttagagtggaggtttgacagccgcctagcatttcatcacgtggcccgagagctgcatccggagtacttcaagaactgctgacatcgagcttgctacaagggactttccgctggggactttccagggaggcgtggcctgggcgggactggggagtggcgagccctcagatcctgcatataagcagctgctttttgcctgtactgggtctctctggttagaccagatctgagcctgggagctctctggctaactagggaacccactgcttaagcctcaataaagcttgccttgagtgcttcaagtagtgtgtgcccgtctgttgtgtgactctggtaactagagatccctcagacccttttagtcagtgtggaaaatctctagca"""
hxb2_rev_comp = """tgctagagattttccacactgactaaaagggtctgagggatctctagttaccagagtcacacaacagacgggcacacactacttgaagcactcaaggcaagctttattgaggcttaagcagtgggttccctagttagccagagagctcccaggctcagatctggtctaaccagagagacccagtacaggcaaaaagcagctgcttatatgcaggatctgagggctcgccactccccagtcccgcccaggccacgcctccctggaaagtccccagcggaaagtcccttgtagcaagctcgatgtcagcagttcttgaagtactccggatgcagctctcgggccacgtgatgaaatgctaggcggctgtcaaacctccactctaacacttctctctccgggtcatccatcccatgcaggctcacagggtgtaacaagctggtgttctctcctttattggcctcttctatcttatctggctcaactggtactagcttgtagcaccatccaaaggtcagtggatatctgacccctggccctggtgtgtagttctgctaatcagggaagtagccttgtgtgtggtagatccacagatcaaggatatcttgtcttctttgggagtgaattagcccttccagtccccccttttcttttaaaaagtggctaagatctacagctgccttgtaagtcattggtcttaaaggtacctgaggtgtgactggaaaacccacctcctcctcctcttgtgcttctagccaggcacaagcagcattggtagctgctgtattgctacttgtgattgctccatgtttttccaggtctcgagatgctgctcccaccctatctgctgctggctcagctcgtctcattctttcccttacagtaggccatccaatcacactactttttgaccacttgccacccatcttatagcaaaatcctttccaagccctgtcttattcttctaggtatgtggcgaatagctctacaagctccttgtactacttctataaccctatctgtcccctcagctactgctatggctgtggcattgagcaagctaacagcactattctttagttcctgactccaatactgtaggagattccaccaatatttgagggcttcccaccccctgcgtcccagaagttccacaatcctcgttacaatcaagagtaagtctctcaagcggtggtagctgaagaggcacaggctccgcagatcgtcccagataagtgccaaggatccgttcactaatcgaatggatctgtctctgtctctctctccaccttcttcttctattccttcgggcctgtcgggtcccctcggggttgggaggtgggtctgaaacgataatggtgaatatccctgcctaactctattcactatagaaagtacagcaaaaactattcttaaacctaccaagcctcctactatcattatgaataattttatataccacagccaatttgttatgttaaaccaattccacaaacttgcccatttatctaattccaataattcttgttcattcttttcttgctggttttgcgattcttcaattaaggagtgtattaagcttgtgtaattgttaatttctctgtcccactccatccaggtcgtgtgattccaaatctgttccagagatttattactccaactagcattccaaggcacagcagtggtgcaaatgagttttccagagcaaccccaaatccccaggagctgttgatcctttaggtatctttccacagccaggattcttgcctggagctgcttgatgccccagactgtgagttgcaacagatgctgttgcgcctcaatagccctcagcaaattgttctgctgctgcactataccagacaataattgtctggcctgtaccgtcagcgtcattgaggctgcgcccatagtgcttcctgctgctcccaagaacccaaggaacaaagctcctattcccactgctcttttttctctctgcaccactcttctctttgccttggtgggtgctactcctaatggttcaatttttactactttatatttatataattcacttctccaattgtccctcatatctcctcctccaggtctgaagatctcggactcattgttgctattaccaccatctcttgttaatagcagccctgtaatatttgatgaacatctaatttgtccactgatgggaggggcatacattgcttttcctactttctgccacatgtttataatttgttttattctgcatgggagggtgattgtgtcacttccttcagtgttatttgacccttcagtactccaagtactattaaaccaagtactattaaacagttgtgttgaattacagtagaaaaattcccctccacaattaaaactgtgcgttacaatttctgggtcccctcctgaggattgcttaaagattattgttttattatttccaaattgttctcttaatttgctagctatctgttttaaagtgttattccattttgctctactaatgttacaatgtgcttgtctcatatttcctatttttcctattgtaacaaatgctctccctggtcctctctggatacggattctttttcttgtattgttgttgggtcttgtacaattaatttctacagatgtgttcagctgtactattatggttttagcattgtccgtgaaattgacagatctaattactacctcttcttctgctagactgccatttaacagcagttgagttgatactactggcctaattccatgtgtacattgtactgtgctgacatttgtacatggtcctgttccattgaacgtcttattattacattttagaatcgcaaaaccagccggggcacaataatgtatgggaattggctcaaaggatacctttggacaggcctgtgtaatgactgaggtgttacaacttgtcaacttatagctggtagtatcattatctattggtattatatcaagtttataaaaaaatgcatattctttctgcaccttacctcttatgcttgtgctgatattgaaagagcagttttttatctctcctttctccattatcattctcccgctactactattggtattagtatcattcttcaaatcagtgcactttaaactaacacagagtggggttaattttacacatggctttaggctttgatcccataaactgattatatcctcatgcatctgttctaccatgtcatttttccacatgttaaaattttctgtcacatttaccaatactacttcttgtgggttggggtctgtgggtacacaggcatgtgtggcccaaacattatgtacctctgtatcatatgctttagcatctgatgcacaaaatagagtggtggttgcttccttccacacaggtaccccataatagactgtgacccacaatttttctgtagcactacagatcatcaacatcccaaggagcatggtgccccatctccacccccatctccacaagtgctgatatttctccttcactctcattgccactgtcttctgctctttctattagtctatcaattaacctgtctatttttctttgtcttaatattttcctatattctatgattactatggaccacacaactattgctattattattgctactactaatgctactattgctactattggtataggttgcgttacatgtactacttactgctttgatagagaagcttgatgagtctgactgttctgatgagctcttcgtcgctgtctccgcttcttcctgccataggagatgcctaaggcttttgttatgaaacaaacttggcaatgaaagcaacactttttacaatagcaattggtacaagcagttttaggctgacttcctggatgcttccagggctctagtctaggatctactggctccatttcttgctctcctctgtcgagtaacgcctattctgctatgtcgacacccaattctgaaaatggataaacagcagttgttgcagaattcttattatggcttccactcctgcccaagtatccccataagtttcatagatatgttgccctaagccatggagccaaatcctaggaaaatgtctaacagcttcattcttaagctcctctaaaagctctagtgtccattcattgtgtggctccctctgtggcccttggtcttctggggcttgttccatctatcctctgtcagtttcgtaacactaggcaaaggtggctttatcttttttggtgttattaatgctgctagtgccaagtattgtagagatcctaccttgttatgtcctgcttgatattcacacctagggctaactatgtgtcctaataaggcctttcttatagcagagtctgaaaaacagtcaaagtaatacagatgaattagttggtctgctagttcagggtctacttgtgtgctatatctctttttcctccattctatggagactccctgacccaaatgccagtctctttctcctgtatgcagaccccaatatgttgttattaccaatctagcatcccctagtgggatgtgtacttctgaacttattcttggatgagggctttcatagtgatgtctataaaaccatcccctagctttccctgaaacatacatatggtgttttactaaacttttccatgttctaatcctcatcctgtctacttgccacacaatcatcacctgccatctgttttccataatccctaatgatctttgcttttcttcttggcactacttttatgtcactattatcttgtattactactgccccttcacctttccagaggagctttgctggtcctttccaaagtggatttctgctgtccctgtaataaacccgaaaattttgaatttttgtaatttgtttttgtaattctttagtttgtatgtctgttgctattatgtctactattctttcccctgcactgtaccccccaatccccccttttcttttaaaattgtggatgaatactgccatttgtactgctgtcttaagatgttcagcctgatctcttacctgtcctataattttctttaattctttattcatagattctactactccttgactttggggattgtagggaattccaaattcctgcttgattcccgcccaccaacaggcggccctaaccgtagcaccggtgaaattgctgccattgtcagtatgtattgtttttactggccatcttcctgctaattttaaaagaaaatatgctgtttcctgccctgtttctgctggaataacttctgcttctatatatccactggctacatgaactgctaccaggataacttttccttctaaatgtgtacaatctagttgccatattcctggactacagtctacttgtccatgcatggcttctccttttagctgacatttatcacagctggctactatttcttttgctactacaggtggcaggttaaaatcactagccattgctctccaattactgtgatatttctcatgttcatcttgggccttatctattccatctaaaaatagtactttcctgattccagcactgactaatttatctacttgttcatttcctccaattcctttgtgtgctggtacccatgccagatagaccttttccttttttattaactgctctattatttgattgactaactctgattcactttgatctggttgtgcttgaatgattcctaatgcatattgtgagtctgttactatgtttacttctaatcccgaatcctgcaaagctagataaattgcttgtaactcagtcttctgatttgttgtgtcagttagggtgacaactttttgtcttcctctattagtaacatatcctgcttttcctaatttagtctccctgttagctgccccatctacatagaaggtttctgctcctactatgggttctttctctaactggtaccataatttcactaagggaggggtattaacaaactcccactcaggaatccaggtggcttgccaatactctgtccaccatgtttcccatgtttccttttgtatgggcagtttaaatttaggagtctttccccatattactatgctttctgtggttattttttgcactgcctctgttaattgttttacatcattagtgtgggcacccctcattcttgcatattttcctgttttcagatttttaaatggctcttgataaatttgatatgtccattggccttgcccctgcttctgtatttctgctattaagtcttttgatgggtcataatacactccatgtactggttcttttagaatctctctgttttctgccagttctagctctgcttcttctgttagtggtattacttctgttagtgctttggttcctctaaggagtttacataattgccttactttaatccctgggtaaatctgacttgcccaattcaatttccccactaacttctgtatgtcattgacagtccagctgtctttttctggcagcactataggctgtactgtccatttatcaggatggagttcataacccatccaaaggaatggaggttctttctgatgttttttgtctggtgtggtaagtccccacctcaacagatgttgtctcagctcctctatttttgttctatgctgccctatttctaagtcagatcctacatacaaatcatccatgtattgatagataactatgtctggattttgttttctaaaaggctctaagatttttgtcatgctactttggaatattgctggtgatcctttccatccctgtggaagcacattgtactgatatctaatccctggtgtctcattgtttatactaggtatggtaaatgcagtatacttcctgaagtcttcatctaagggaactgaaaaatatgcatcacccacatccagtactgttactgattttttcttttttaaccctgcgggatgtggtattcctaattgaacttcccagaagtcttgagttctcttattaagttctctgaaatctactaattttctccatttagtactgtcttttttctttatggcaaatactggagtattgtatggattttcaggcccaatttttgaaattttcccttccttttccatctctgtacaaatttctactaatgcttttattttttcttctgtcaatggccattgtttaacttttgggccatccattcctggctttaattttactggtacagtctcaatagggctaatgggaaaatttaaagtgcaaccaatctgagtcaacagatttcttccaattatgttgacaggtgtaggtcctactaatactgtacctatagctttatgtccacagatttctatgagtatctgatcatactgtcttactttgataaaacctccaattccccctatcatttttggtttccatcttcctggcaaactcatttcttctaatactgtatcatctgctcctgtatctaatagagcttcctttagttgcccccctatctttattgtgacgaggggtcgttgccaaagagtgacctgagggaagttaaaggatacagttccttgtctatcggctcctgcttctgagggggagttgttgtctctaccccagacctgaagctctcttctggtggggctgttggctctggtctgctctgaagaaaattccctggccttcccttgtaggaaggccagatcttccctaaaaaattagcctgtctctcagtacaatctttcatttggtgtccttcctttccacatttccaacagccctttttcctaggggccctgcaatttctggctgtgtgcccttctttgccacaattgaaacacttaacaatctttctttggttcctaaaattgcctctctgcatcattatggtagctgaatttgttacttggctcattgcttcagccaaaactcttgccttatggccgggtcctcctactccctgacatgctgtcatcatttcttctagtgtagccgctggtcccaatgcttttaaaatagtcttacaatctgggttcgcattttggaccaacaaggtttctgtcatccaattttttacctcctgtgaagcttgctcggctcttagagttttatagaaccggtctacatagtctctaaagggttcctttggtccttgtcttatgtccagaatgctggtagggctatacattcttactattttatttaatcccaggattatccatcttttataaatttctcctactgggataggtggattatttgtcatccatcctatttgttcctgaagggtactagtagttcctgctatgtcacttccccttggttctctcatctggcctggtgcaataggccctgcatgcactggatgcactctatcccattctgcagcttcctcattgatggtctcttttaacatttgcatggctgcttgatgtccccccactgtgtttagcatggtgtttaaatcttgtggggtggctccttctgataatgctgaaaacatgggtatcacttctgggctgaaagccttctcttctactacttttacccatgcatttaaagttctaggtgatatggcctgatgtaccatttgcccctggatgttctgcactatagggtaattttggctgacctgattgctgtgtcctgtgtcagctgctgcttgctgtgcttttttcttacttttgttttgctcttcctctatcttgtctaaagcttccttggtgtcttttatctctatcctttgatgcacacaatagagggttgctactgtattatataatgatctaagttcttctgatcctgtctgaagggatggttgtagctgtcccagtatttgtctacagccttctgatgtttctaacaggccaggattaactgcgaatcgttctagctccctgcttgcccatactatatgttttaatttatattttttctttccccctggccttaaccgaattttttcccatcgatctaattctcccccgcttaatactgacgctctcgcacccatctctctccttctagcctccgctagtcaaaatttttggcgtactcaccagtcgccgcccctcgcctcttgccgtgcgcgcttcagcaagccgagtcctgcgtcgagagagctcctctggtttccctttcgctttcaggtccctgttcgggcgccactgctagagattttccacactgactaaaagggtctgagggatctctagttaccagagtcacacaacagacgggcacacactacttgaagcactcaaggcaagctttattgaggcttaagcagtgggttccctagttagccagagagctcccaggctcagatctggtctaaccagagagacccagtacaggcaaaaagcagctgcttatatgcaggatctgagggctcgccactccccagtcccgcccaggccacgcctccctggaaagtccccagcggaaagtcccttgtagcaagctcgatgtcagcagttcttgaagtactccggatgcagctctcgggccatgtgatgaaatgctaggcggctgtcaaacctccactctaacacttctctctccgggtcatccattccatgcaggctcacagggtgtaacaagctggtgttctctcctttgttggcttcttctaacttctctggctcaactggtactagcttgtagcaccatccaaaggtcagtggatatctgatccctggccctggtgtgtagttctgctaatcagggaagtagccttgtgtgtggtagatccacagatcaaggatatcttgtcttcgttgggagtgaattagcccttcca"""


def count_seqs(fasta_fn):
    dct = st.fasta_to_dct(fasta_fn)
    return len(dct)


def mean_seq_len(fasta_fn):
    dct = st.fasta_to_dct(fasta_fn)
    seqs = list(dct.values())
    mean_len = sum(map(len, seqs)) / len(seqs)
    return mean_len


def build_dumb_cons(fasta_fn):
    dumb_cons = ""

    return dumb_cons


def plot_on_hxb2_map(seq, file_location):
    fn = os.path.join(file_location, "seqLocate_HIV_map.png")
    return fn


def orientation(fasta_fn):
    # for each seqence in file, determines if they are in 3' to 5' or 5' to 3' orientation
    # returns a tuple of: (summary_all_the_same_orientation,
#                          summary_all_forward,
#                          dictionary)
#     dictionary is: sequence ids as keys, with Bool True / False to
#     indicating forward or reverse compliment orientation.
    all_same = None
    all_forward = None
    dct_each_seq = {}
    dmb_cons = build_dumb_cons(fasta_fn)
    print(dmb_cons)

    forward_alignments = pairwise2.align.localxx(hxb2_forward, dmb_cons)
    if len(forward_alignments) > 0:
        top_align = forward_alignments[0]
        print(top_align)
    # for a in pairwise2.align.localxx(hxb2_rev_comp, dmb_cons):
    #     print(format_alignment(*a))
    return (all_same, all_forward, dct_each_seq)


def main(infile):
    # templating informed from here: https://pbpython.com/pdf-reports.html
    orientation(infile)
    sys.exit()

    print("Describing HIV sequence alignment: {}".format(infile))
    base_path = os.path.split(infile)[0]
    fn_no_ext = os.path.splitext(os.path.split(infile)[1])[0]
    outfn_html = os.path.join(base_path, fn_no_ext + ".html")
    outfn_pdf = os.path.join(base_path, fn_no_ext + ".pdf")
    print("output report can be found here: {}".format(outfn_pdf))


    env = Environment(loader=FileSystemLoader('./html_reports/'))
    template = env.get_template("myreport.html")
    template_vars = {"title": "Description of fasta file",
                     "numberOfSequences": count_seqs(infile),
                     "averageLength": mean_seq_len(infile),
                     }

    # Render our file and create the PDF using our css style file
    html_out = template.render(template_vars)
    with open(outfn_html, "w") as fw:
        fw.write(html_out)
    HTML(string=html_out).write_pdf(outfn_pdf, stylesheets=["./html_reports/style.css"])



if __name__ == "__main__":
    parser = argparse.ArgumentParser(description='some program description')
    parser.add_argument('-in', '--infile', type=str,
                        help='.fasta formatted file containing HIV sequences. The data in this file will be '
                             'placed in context as an output report', required=True)

    args = parser.parse_args()
    infile = args.infile

    main(infile)

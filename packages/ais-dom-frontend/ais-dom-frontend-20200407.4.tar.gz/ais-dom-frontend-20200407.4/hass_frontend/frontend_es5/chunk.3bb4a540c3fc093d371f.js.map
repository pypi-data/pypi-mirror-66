{"version":3,"sources":["webpack:///./src/common/datetime/seconds_to_duration.ts","webpack:///./src/common/entity/timer_time_remaining.ts","webpack:///./src/common/datetime/duration_to_seconds.ts","webpack:///./src/components/ha-label-badge.ts","webpack:///./src/components/entity/ha-state-label-badge.ts","webpack:///./src/panels/lovelace/cards/hui-picture-elements-card.ts"],"names":["__webpack_require__","d","__webpack_exports__","secondsToDuration","leftPad","num","concat","h","Math","floor","m","s","timer_time_remaining_timerTimeRemaining","timerTimeRemaining","stateObj","duration","parts","timeRemaining","attributes","remaining","split","map","Number","state","now","Date","getTime","madeActive","last_changed","max","HaLabelBadge","property","html","_templateObject","classMap","value","big","Boolean","this","length","icon","image","_templateObject2","_templateObject3","label","_templateObject4","description","_templateObject5","css","_templateObject6","changedProperties","_get","_getPrototypeOf","prototype","call","has","shadowRoot","getElementById","style","backgroundImage","LitElement","customElements","define","_decorate","customElement","_initialize","_LitElement","HaStateLabelBadge","_LitElement2","_getPrototypeOf2","_this","_classCallCheck","_len","arguments","args","Array","_key","apply","_assertThisInitialized","_inherits","F","kind","decorators","key","_connected","startInterval","clearInterval","_classMap","hass","localize","domain","computeStateDomain","_defineProperty","_computeValue","_computeIcon","entity_picture","_computeLabel","_timerTimeRemaining","name","computeStateName","domainIcon","stateIcon","includes","unit_of_measurement","_clearInterval","toString","_updateRemaining","undefined","_this2","calculateTimerRemaining","window","setInterval","static","HuiPictureElementsCard","entities","entitiesFallback","type","elements","entity","findEntities","top","left","_hass","_i","_Array$from","from","querySelectorAll","config","Error","camera_image","state_image","isArray","_config","changedProps","oldHass","get","oldConfig","themes","theme","applyThemesOnElement","title","state_filter","camera_view","aspect_ratio","elementConfig","element","createStyledHuiElement"],"mappings":"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","file":"chunk.3bb4a540c3fc093d371f.js","sourcesContent":["const leftPad = (num: number) => (num < 10 ? `0${num}` : num);\n\nexport default function secondsToDuration(d: number) {\n  const h = Math.floor(d / 3600);\n  const m = Math.floor((d % 3600) / 60);\n  const s = Math.floor((d % 3600) % 60);\n\n  if (h > 0) {\n    return `${h}:${leftPad(m)}:${leftPad(s)}`;\n  }\n  if (m > 0) {\n    return `${m}:${leftPad(s)}`;\n  }\n  if (s > 0) {\n    return \"\" + s;\n  }\n  return null;\n}\n","import { HassEntity } from \"home-assistant-js-websocket\";\nimport durationToSeconds from \"../datetime/duration_to_seconds\";\n\nexport const timerTimeRemaining = (stateObj: HassEntity) => {\n  let timeRemaining = durationToSeconds(stateObj.attributes.remaining);\n\n  if (stateObj.state === \"active\") {\n    const now = new Date().getTime();\n    const madeActive = new Date(stateObj.last_changed).getTime();\n    timeRemaining = Math.max(timeRemaining - (now - madeActive) / 1000, 0);\n  }\n\n  return timeRemaining;\n};\n","export default function durationToSeconds(duration: string): number {\n  const parts = duration.split(\":\").map(Number);\n  return parts[0] * 3600 + parts[1] * 60 + parts[2];\n}\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  CSSResult,\n  css,\n  property,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport \"./ha-icon\";\n\nclass HaLabelBadge extends LitElement {\n  @property() public value?: string;\n  @property() public icon?: string;\n  @property() public label?: string;\n  @property() public description?: string;\n  @property() public image?: string;\n\n  protected render(): TemplateResult {\n    return html`\n      <div class=\"badge-container\">\n        <div class=\"label-badge\" id=\"badge\">\n          <div\n            class=\"${classMap({\n              value: true,\n              big: Boolean(this.value && this.value.length > 4),\n            })}\"\n          >\n            ${this.icon && !this.value && !this.image\n              ? html`\n                  <ha-icon .icon=\"${this.icon}\"></ha-icon>\n                `\n              : \"\"}\n            ${this.value && !this.image\n              ? html`\n                  <span>${this.value}</span>\n                `\n              : \"\"}\n          </div>\n          ${this.label\n            ? html`\n                <div\n                  class=\"${classMap({\n                    label: true,\n                    big: this.label.length > 5,\n                  })}\"\n                >\n                  <span>${this.label}</span>\n                </div>\n              `\n            : \"\"}\n        </div>\n        ${this.description\n          ? html`\n              <div class=\"title\">${this.description}</div>\n            `\n          : \"\"}\n      </div>\n    `;\n  }\n\n  static get styles(): CSSResult[] {\n    return [\n      css`\n        .badge-container {\n          display: inline-block;\n          text-align: center;\n          vertical-align: top;\n        }\n        .label-badge {\n          position: relative;\n          display: block;\n          margin: 0 auto;\n          width: var(--ha-label-badge-size, 2.5em);\n          text-align: center;\n          height: var(--ha-label-badge-size, 2.5em);\n          line-height: var(--ha-label-badge-size, 2.5em);\n          font-size: var(--ha-label-badge-font-size, 1.5em);\n          border-radius: 50%;\n          border: 0.1em solid var(--ha-label-badge-color, var(--primary-color));\n          color: var(--label-badge-text-color, rgb(76, 76, 76));\n\n          white-space: nowrap;\n          background-color: var(--label-badge-background-color, white);\n          background-size: cover;\n          transition: border 0.3s ease-in-out;\n        }\n        .label-badge .value {\n          font-size: 90%;\n          overflow: hidden;\n          text-overflow: ellipsis;\n        }\n        .label-badge .value.big {\n          font-size: 70%;\n        }\n        .label-badge .label {\n          position: absolute;\n          bottom: -1em;\n          /* Make the label as wide as container+border. (parent_borderwidth / font-size) */\n          left: -0.2em;\n          right: -0.2em;\n          line-height: 1em;\n          font-size: 0.5em;\n        }\n        .label-badge .label span {\n          box-sizing: border-box;\n          max-width: 100%;\n          display: inline-block;\n          background-color: var(--ha-label-badge-color, var(--primary-color));\n          color: var(--ha-label-badge-label-color, white);\n          border-radius: 1em;\n          padding: 9% 16% 8% 16%; /* mostly apitalized text, not much descenders => bit more top margin */\n          font-weight: 500;\n          overflow: hidden;\n          text-transform: uppercase;\n          text-overflow: ellipsis;\n          transition: background-color 0.3s ease-in-out;\n          text-transform: var(--ha-label-badge-label-text-transform, uppercase);\n        }\n        .label-badge .label.big span {\n          font-size: 90%;\n          padding: 10% 12% 7% 12%; /* push smaller text a bit down to center vertically */\n        }\n        .badge-container .title {\n          margin-top: 1em;\n          font-size: var(--ha-label-badge-title-font-size, 0.9em);\n          width: var(--ha-label-badge-title-width, 5em);\n          font-weight: var(--ha-label-badge-title-font-weight, 400);\n          overflow: hidden;\n          text-overflow: ellipsis;\n          line-height: normal;\n          color: #fff;\n        }\n      `,\n    ];\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n    if (changedProperties.has(\"image\")) {\n      this.shadowRoot!.getElementById(\"badge\")!.style.backgroundImage = this\n        .image\n        ? `url(${this.image})`\n        : \"\";\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-label-badge\": HaLabelBadge;\n  }\n}\n\ncustomElements.define(\"ha-label-badge\", HaLabelBadge);\n","import {\n  LitElement,\n  html,\n  PropertyValues,\n  TemplateResult,\n  css,\n  CSSResult,\n  customElement,\n  property,\n} from \"lit-element\";\n\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport { HomeAssistant } from \"../../types\";\n\nimport { computeStateDomain } from \"../../common/entity/compute_state_domain\";\nimport { computeStateName } from \"../../common/entity/compute_state_name\";\nimport { domainIcon } from \"../../common/entity/domain_icon\";\nimport { stateIcon } from \"../../common/entity/state_icon\";\nimport { timerTimeRemaining } from \"../../common/entity/timer_time_remaining\";\nimport secondsToDuration from \"../../common/datetime/seconds_to_duration\";\n\nimport \"../ha-label-badge\";\n\n@customElement(\"ha-state-label-badge\")\nexport class HaStateLabelBadge extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() public state?: HassEntity;\n\n  @property() public name?: string;\n\n  @property() public icon?: string;\n\n  @property() public image?: string;\n\n  @property() private _timerTimeRemaining?: number;\n\n  private _connected?: boolean;\n\n  private _updateRemaining?: number;\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this._connected = true;\n    this.startInterval(this.state);\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._connected = false;\n    this.clearInterval();\n  }\n\n  protected render(): TemplateResult {\n    const state = this.state;\n\n    if (!state) {\n      return html`\n        <ha-label-badge\n          class=\"warning\"\n          label=\"${this.hass!.localize(\"state_badge.default.error\")}\"\n          icon=\"hass:alert\"\n          description=\"${this.hass!.localize(\n            \"state_badge.default.entity_not_found\"\n          )}\"\n        ></ha-label-badge>\n      `;\n    }\n\n    const domain = computeStateDomain(state);\n\n    return html`\n      <ha-label-badge\n        class=\"${classMap({\n          [domain]: true,\n          \"has-unit_of_measurement\": \"unit_of_measurement\" in state.attributes,\n        })}\"\n        .value=\"${this._computeValue(domain, state)}\"\n        .icon=\"${this.icon ? this.icon : this._computeIcon(domain, state)}\"\n        .image=\"${this.icon\n          ? \"\"\n          : this.image\n          ? this.image\n          : state.attributes.entity_picture}\"\n        .label=\"${this._computeLabel(domain, state, this._timerTimeRemaining)}\"\n        .description=\"${this.name ? this.name : computeStateName(state)}\"\n      ></ha-label-badge>\n    `;\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n\n    if (this._connected && changedProperties.has(\"state\")) {\n      this.startInterval(this.state);\n    }\n  }\n\n  private _computeValue(domain: string, state: HassEntity) {\n    switch (domain) {\n      case \"binary_sensor\":\n      case \"device_tracker\":\n      case \"person\":\n      case \"updater\":\n      case \"sun\":\n      case \"alarm_control_panel\":\n      case \"timer\":\n        return null;\n      case \"sensor\":\n      default:\n        return state.state === \"unknown\"\n          ? \"-\"\n          : this.hass!.localize(`component.${domain}.state.${state.state}`) ||\n              state.state;\n    }\n  }\n\n  private _computeIcon(domain: string, state: HassEntity) {\n    if (state.state === \"unavailable\") {\n      return null;\n    }\n    switch (domain) {\n      case \"alarm_control_panel\":\n        if (state.state === \"pending\") {\n          return \"hass:clock-fast\";\n        }\n        if (state.state === \"armed_away\") {\n          return \"hass:nature\";\n        }\n        if (state.state === \"armed_home\") {\n          return \"hass:home-variant\";\n        }\n        if (state.state === \"armed_night\") {\n          return \"hass:weather-night\";\n        }\n        if (state.state === \"armed_custom_bypass\") {\n          return \"hass:shield-home\";\n        }\n        if (state.state === \"triggered\") {\n          return \"hass:alert-circle\";\n        }\n        // state == 'disarmed'\n        return domainIcon(domain, state.state);\n      case \"binary_sensor\":\n      case \"device_tracker\":\n      case \"updater\":\n      case \"person\":\n        return stateIcon(state);\n      case \"sun\":\n        return state.state === \"above_horizon\"\n          ? domainIcon(domain)\n          : \"hass:brightness-3\";\n      case \"timer\":\n        return state.state === \"active\" ? \"hass:timer\" : \"hass:timer-off\";\n      default:\n        return null;\n    }\n  }\n\n  private _computeLabel(domain, state, _timerTimeRemaining) {\n    if (\n      state.state === \"unavailable\" ||\n      [\"device_tracker\", \"alarm_control_panel\", \"person\"].includes(domain)\n    ) {\n      // Localize the state with a special state_badge namespace, which has variations of\n      // the state translations that are truncated to fit within the badge label. Translations\n      // are only added for device_tracker, alarm_control_panel and person.\n      return (\n        this.hass!.localize(`state_badge.${domain}.${state.state}`) ||\n        this.hass!.localize(`state_badge.default.${state.state}`) ||\n        state.state\n      );\n    }\n    if (domain === \"timer\") {\n      return secondsToDuration(_timerTimeRemaining);\n    }\n    return state.attributes.unit_of_measurement || null;\n  }\n\n  private clearInterval() {\n    if (this._updateRemaining) {\n      clearInterval(this._updateRemaining);\n      this._updateRemaining = undefined;\n    }\n  }\n\n  private startInterval(stateObj) {\n    this.clearInterval();\n    if (stateObj && computeStateDomain(stateObj) === \"timer\") {\n      this.calculateTimerRemaining(stateObj);\n\n      if (stateObj.state === \"active\") {\n        this._updateRemaining = window.setInterval(\n          () => this.calculateTimerRemaining(this.state),\n          1000\n        );\n      }\n    }\n  }\n\n  private calculateTimerRemaining(stateObj) {\n    this._timerTimeRemaining = timerTimeRemaining(stateObj);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        cursor: pointer;\n      }\n\n      ha-label-badge {\n        --ha-label-badge-color: var(--label-badge-red, #ff9800);\n      }\n      ha-label-badge.has-unit_of_measurement {\n        --ha-label-badge-label-text-transform: none;\n      }\n\n      ha-label-badge.binary_sensor,\n      ha-label-badge.updater {\n        --ha-label-badge-color: var(--label-badge-blue, #ca510b);\n      }\n\n      .red {\n        --ha-label-badge-color: var(--label-badge-red, #ff9800);\n      }\n\n      .blue {\n        --ha-label-badge-color: var(--label-badge-blue, #039be5);\n      }\n\n      .green {\n        --ha-label-badge-color: var(--label-badge-green, #0da035);\n      }\n\n      .yellow {\n        --ha-label-badge-color: var(--label-badge-yellow, #f4b400);\n      }\n\n      .grey {\n        --ha-label-badge-color: var(--label-badge-grey, var(--paper-grey-500));\n      }\n\n      .warning {\n        --ha-label-badge-color: var(--label-badge-yellow, #fce588);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-state-label-badge\": HaStateLabelBadge;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  css,\n  CSSResult,\n  PropertyValues,\n} from \"lit-element\";\n\nimport { createStyledHuiElement } from \"./picture-elements/create-styled-hui-element\";\nimport { LovelaceCard } from \"../types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceElementConfig, LovelaceElement } from \"../elements/types\";\nimport { PictureElementsCardConfig } from \"./types\";\nimport { applyThemesOnElement } from \"../../../common/dom/apply_themes_on_element\";\nimport { findEntities } from \"../common/find-entites\";\n\n@customElement(\"hui-picture-elements-card\")\nclass HuiPictureElementsCard extends LitElement implements LovelaceCard {\n  public static getStubConfig(\n    hass: HomeAssistant,\n    entities: string[],\n    entitiesFallback: string[]\n  ): PictureElementsCardConfig {\n    const maxEntities = 1;\n    const foundEntities = findEntities(\n      hass,\n      maxEntities,\n      entities,\n      entitiesFallback,\n      [\"sensor\", \"binary_sensor\"]\n    );\n\n    return {\n      type: \"picture-elements\",\n      elements: [\n        {\n          type: \"state-badge\",\n          entity: foundEntities[0] || \"\",\n          style: {\n            top: \"32%\",\n            left: \"40%\",\n          },\n        },\n      ],\n      image: \"https://demo.home-assistant.io/stub_config/floorplan.png\",\n    };\n  }\n\n  @property() private _config?: PictureElementsCardConfig;\n\n  private _hass?: HomeAssistant;\n\n  set hass(hass: HomeAssistant) {\n    this._hass = hass;\n    for (const el of Array.from(\n      this.shadowRoot!.querySelectorAll(\"#root > *\")\n    )) {\n      const element = el as LovelaceElement;\n      element.hass = this._hass;\n    }\n  }\n\n  public getCardSize(): number {\n    return 4;\n  }\n\n  public setConfig(config: PictureElementsCardConfig): void {\n    if (!config) {\n      throw new Error(\"Invalid Configuration\");\n    } else if (\n      !(config.image || config.camera_image || config.state_image) ||\n      (config.state_image && !config.entity)\n    ) {\n      throw new Error(\"Invalid Configuration: image required\");\n    } else if (!Array.isArray(config.elements)) {\n      throw new Error(\"Invalid Configuration: elements required\");\n    }\n\n    this._config = config;\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this._hass) {\n      return;\n    }\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    const oldConfig = changedProps.get(\"_config\") as\n      | PictureElementsCardConfig\n      | undefined;\n\n    if (\n      !oldHass ||\n      !oldConfig ||\n      oldHass.themes !== this.hass.themes ||\n      oldConfig.theme !== this._config.theme\n    ) {\n      applyThemesOnElement(this, this._hass.themes, this._config.theme);\n    }\n  }\n\n  protected render(): TemplateResult {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      <ha-card .header=\"${this._config.title}\">\n        <div id=\"root\">\n          <hui-image\n            .hass=${this._hass}\n            .image=${this._config.image}\n            .stateImage=${this._config.state_image}\n            .stateFilter=${this._config.state_filter}\n            .cameraImage=${this._config.camera_image}\n            .cameraView=${this._config.camera_view}\n            .entity=${this._config.entity}\n            .aspectRatio=${this._config.aspect_ratio}\n          ></hui-image>\n          ${this._config.elements.map(\n            (elementConfig: LovelaceElementConfig) => {\n              const element = createStyledHuiElement(elementConfig);\n              element.hass = this._hass;\n\n              return element;\n            }\n          )}\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      #root {\n        position: relative;\n      }\n\n      .element {\n        position: absolute;\n        transform: translate(-50%, -50%);\n      }\n\n      ha-card {\n        overflow: hidden;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-picture-elements-card\": HuiPictureElementsCard;\n  }\n}\n"],"sourceRoot":""}